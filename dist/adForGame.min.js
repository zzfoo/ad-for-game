!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).AFG=t()}}(function(){return function r(a,s,d){function u(e,t){if(!s[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var i=s[e]={exports:{}};a[e][0].call(i.exports,function(t){return u(a[e][1][t]||t)},i,i.exports,r,a,s,d)}return s[e].exports}for(var c="function"==typeof require&&require,t=0;t<d.length;t++)u(d[t]);return u}({1:[function(t,e,n){var o=t("./src/Ad.js"),i=t("./src/GoogleAd.js"),r=t("./src/WechatAd.js");e.exports={EVENTS:o.EVENTS,AD_STATUS:o.AD_STATUS,AdManager:o.AdManager,Ad:o.Ad,GoogleAdManager:i.GoogleAdManager,GoogleAd:i.GoogleAd,WechatAdManager:r.WechatAdManager,WechatAd:r.WechatAd}},{"./src/Ad.js":3,"./src/GoogleAd.js":4,"./src/WechatAd.js":5}],2:[function(t,e,n){"use strict";var o=Object.prototype.hasOwnProperty,h="~";function i(){}function s(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(t,e,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var r=new s(n,o||t,i),a=h?h+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],r]:t._events[a].push(r):(t._events[a]=r,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(h=!1)),a.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)o.call(t,e)&&n.push(h?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=h?h+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,r=new Array(i);o<i;o++)r[o]=n[o].fn;return r},a.prototype.listenerCount=function(t){var e=h?h+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,o,i,r){var a=h?h+t:t;if(!this._events[a])return!1;var s,d,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,o),!0;case 5:return u.fn.call(u.context,e,n,o,i),!0;case 6:return u.fn.call(u.context,e,n,o,i,r),!0}for(d=1,s=new Array(c-1);d<c;d++)s[d-1]=arguments[d];u.fn.apply(u.context,s)}else{var l,f=u.length;for(d=0;d<f;d++)switch(u[d].once&&this.removeListener(t,u[d].fn,void 0,!0),c){case 1:u[d].fn.call(u[d].context);break;case 2:u[d].fn.call(u[d].context,e);break;case 3:u[d].fn.call(u[d].context,e,n);break;case 4:u[d].fn.call(u[d].context,e,n,o);break;default:if(!s)for(l=1,s=new Array(c-1);l<c;l++)s[l-1]=arguments[l];u[d].fn.apply(u[d].context,s)}}return!0},a.prototype.on=function(t,e,n){return r(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return r(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,n,o){var i=h?h+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var r=this._events[i];if(r.fn)r.fn!==e||o&&!r.once||n&&r.context!==n||u(this,i);else{for(var a=0,s=[],d=r.length;a<d;a++)(r[a].fn!==e||o&&!r[a].once||n&&r[a].context!==n)&&s.push(r[a]);s.length?this._events[i]=1===s.length?s[0]:s:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=h?h+t:t,this._events[e]&&u(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=h,a.EventEmitter=a,void 0!==e&&(e.exports=a)},{}],3:[function(t,e,n){var o=t("eventemitter3"),i={LOADED:"loaded",LOAD_ERROR:"load_error",AD_START:"ad_start",AD_SKIPPED:"ad_skipped",AD_COMPLETE:"ad_complete",AD_END:"ad_end",AD_CLICKED:"ad_clicked",AD_DESTROYED:"ad_destroyed"},r={FRESH:1,LOADING:2,LOADED:3,LOAD_FAILED:4,DESTROYED:5},a=function(){},s={inited:null,options:null,_adIndex:null,_adCache:null,_initTimeoutId:null,init:function(t,e){this.inited=!1,this._adCache={},this.options=t;var n=this;this.doInit(function(t){n.inited=!0,e&&e(t)})},doInit:function(t){t&&setTimeout(function(){t(null)},30)},createAd:function(t,e){var n=this.doCreateAd();return e=e||this._generateName(),n.init(e,this,t),this._adCache[e]=n},doCreateAd:function(){return new u},destroyAd:function(t){delete this._adCache[t.name],t.destroy(),this.doDestroyAd(t)},doDestroyAd:function(t){},getAd:function(t){return this._adCache[t]},_generateName:function(){return"ad_"+ ++this._adIndex}};for(var d in s)a.prototype[d]=s[d];var u=function(){o.call(this),this.destroyed=!1},c={status:null,name:null,manager:null,options:null,_loadTimeoutId:null,init:function(t,e,n){this.name=t,this.manager=e,this.options=n,this.status=r.FRESH,this.on(i.LOADED,function(){this.status=r.LOADED},this),this.on(i.LOAD_ERROR,function(){this.status=r.LOAD_FAILED},this),this.doInit()},doInit:function(){},load:function(){this.status=r.LOADING,this.doLoad()},doLoad:function(){var t=this;setTimeout(function(){t.emit(i.LOADED)},30)},show:function(){this.doShow()},doShow:function(){setTimeout(function(){Me.emit(i.AD_COMPLETE),Me.emit(i.AD_END)},30)},destroy:function(){this.doDestroy(),this.removeAllListeners(),this.name=null,this.options=null,this.manager=null},doDestroy:function(){}};for(var d in o.prototype)u.prototype[d]=o.prototype[d];for(var d in c)u.prototype[d]=c[d];e.exports={EVENTS:i,AdManager:a,Ad:u,AD_STATUS:r}},{eventemitter3:2}],4:[function(t,e,n){var c,o=t("./Ad.js"),i=o.EVENTS,r=o.AdManager,a=o.Ad,s=function(){r.call(this)},d={adsLoader:null,_containerElement:null,doInit:function(e){var t=this;window.adsbygoogle=window.adsbygoogle||[],function(t,e,n){var o=document.createElement("script");o.async=!0;var i=!1;o.onload=function(t){i||(i=!0,e&&e(t))},o.onerror=function(t){n&&n(t)};var r=document.head||document.getElementsByTagName("head")[0]||document.documentElement;r.insertBefore(o,r.firstChild),o.src=t}("//imasdk.googleapis.com/js/sdkloader/ima3.js",function(){c=window.google,t._initAdLoader(),e(null)},function(t){e(t)})},_initAdLoader:function(){var t=this.options,e=this._createAdDisplayContainer(t),n=this.adsLoader=new c.ima.AdsLoader(e),i=this;n.addEventListener(c.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(t){var e=t.getUserRequestContext().name,n=i.getAd(e);if(n){var o=t.getAdsManager({currentTime:0,duration:600},n.adsRenderingSettings);n._onAdsManagerLoaded(o)}},!1),n.addEventListener(c.ima.AdErrorEvent.Type.AD_ERROR,function(t){var e=t.getUserRequestContext().name,n=i.getAd(e);if(n){var o=t.getError();n._onAdsLoadError(o)}},!1)},doCreateAd:function(){return new l},displayContainer:function(){this._displayContainerElement(!0)},hideContainer:function(){this._displayContainerElement(!1)},_createAdDisplayContainer:function(t){var e,n;for(var o in t&&(e=t.containerElement,n=t.containerStyle),e?"string"==typeof e&&(e=document.getElementById(e)):e=this._createContainerElement(),n)e.style[o]=n[o];this._containerElement=e,this._displayContainerElement(!1);var i=new c.ima.AdDisplayContainer(e);return i.initialize(),i},_createContainerElement:function(){var t=document.createElement("div"),e=window.innerWidth,n=window.innerHeight,o=t.style,i={position:"absolute",top:"0px",left:"0px",backgroundColor:"rgba(0,0,0,0.75)",width:e+"px",height:n+"px","z-index":9e9};for(var r in i)o[r]=i[r];return document.body.appendChild(t),t},_displayContainerElement:function(t){this._containerElement.style.display=t?"block":"none"},_onAdClosed:function(t){this._displayContainerElement(!1)}};for(var u in r.prototype)s.prototype[u]=r.prototype[u];for(var u in d)s.prototype[u]=d[u];var l=function(){a.call(this)},f={_adsManager:null,adsRenderingSettings:null,doInit:function(){this.on(i.AD_END,function(){Me.manager.hideContainer()})},doDestroy:function(){this._adsManager&&this._adsManager.destroy(),this._adsManager=null,this.adsRenderingSettings=null},doLoad:function(){var t=this.options;this._adsManager=null;var e=t.descriptionPage||window.location.href,n={ad_type:t.adType,client:t.id,description_url:e,videoad_start_delay:t.delay||0,hl:t.language||"en"};t.channel&&(n.channel=t.channel),t.adDuration&&(n.max_ad_duration=t.adDuration),t.skippableAdDuration&&(n.sdmax=t.skippableAdDuration);var o=[];for(var i in n)o.push(i+"="+encodeURIComponent(n[i]));var r="https://googleads.g.doubleclick.net/pagead/ads?"+o.join("&"),a=t.width||window.innerWidth,s=t.height||window.innerHeight;t.width=a,t.height=s;var d=new c.ima.AdsRequest;d.adTagUrl=r,d.forceNonLinearFullSlot=!0,d.linearAdSlotWidth=a,d.linearAdSlotHeight=s,d.nonLinearAdSlotWidth=a,d.nonLinearAdSlotHeight=s,(t.vastLoadTimeout||0===t.vastLoadTimeout)&&(d.vastLoadTimeout=t.vastLoadTimeout);var u=new c.ima.AdsRenderingSettings;u.restoreCustomPlaybackStateOnAdBreakComplete=!0,u.useStyledNonLinearAds=!1,u.useStyledLinearAds=!1,this.adsRenderingSettings=u,this.manager.adsLoader.requestAds(d,{name:ad.name})},doShow:function(){this.manager.displayContainer();var t=this.options;return adsManager.init(t.width,t.height,c.ima.ViewMode.NORMAL),adsManager.start(),!0},_onAdsManagerLoaded:function(t){if(!this.destroyed){this.loaded=!0,this._adsManager=t;var e=this,n=c.ima.AdEvent.Type;this.emit(i.LOADED),t.addEventListener(n.STARTED,function(){e.emit(i.AD_START)}),t.addEventListener(n.COMPLETE,function(){e.emit(i.AD_COMPLETE),e.emit(i.AD_END)});var o=!1;t.addEventListener(n.SKIPPED,function(){o=!0,e.emit(i.AD_SKIPPED),e.emit(i.AD_END)}),t.addEventListener(n.USER_CLOSE,function(){setTimeout(function(){o||(e.emit(i.AD_COMPLETE),e.emit(i.AD_END))},100)}),t.addEventListener(n.CLICK,function(){e.emit(i.AD_CLICKED)})}},_onAdsLoadError:function(t){this.emit(i.LOAD_ERROR,t)}};for(var u in a.prototype)l.prototype[u]=a.prototype[u];for(var u in f)l.prototype[u]=f[u];e.exports={GoogleAdManager:s,GoogleAd:l}},{"./Ad.js":3}],5:[function(t,e,n){var o=t("./Ad.js"),i=o.EVENTS,r=o.AdManager,a=o.Ad,s=function(){r.call(this)},d={doInit:function(t){setTimeout(function(){t(null)},30)},doCreateAd:function(){return new c}};for(var u in r.prototype)s.prototype[u]=r.prototype[u];for(var u in d)s.prototype[u]=d[u];var c=function(){a.call(this)},l={adSingleton:null,doLoad:function(){var e=this,t=this.options,n=this.adSingleton=wx.createRewardedVideoAd({adUnitId:t.adUnitId});n.onLoad(function(){e.emit(i.LOADED)}),n.onError(function(t){e.emit(i.LOAD_ERROR,t.errMsg)}),n.onClose(function(t){t&&t.isEnded||void 0===t?this.emit(i.AD_COMPLETE):this.emit(i.AD_SKIPPED),this.emit(i.AD_END)})},clearTimeout:function(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},doShow:function(){this.adSingleton.show()}};for(var u in a.prototype)c.prototype[u]=a.prototype[u];for(var u in l)c.prototype[u]=l[u];e.exports={WechatAdManager:s,WechatAd:c}},{"./Ad.js":3}]},{},[1])(1)});